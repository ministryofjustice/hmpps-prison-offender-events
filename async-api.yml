asyncapi: 3.0.0
info:
  title: Prison Offender Events
  version: 1.0.0
  description: |
    Events generated by Prison Offender Events.
servers:
  development:
    host: "hmpps-domain-events-dev.live-1.cloud-platform.service.justice.gov.uk"
    protocol: sqs
    description: Development Environment
  preproduction:
    host: "hmpps-domain-events-preprod.live-1.cloud-platform.service.justice.gov.uk"
    protocol: sqs
    description: Pre-production Environment
  production:
    host: "hmpps-domain-events-prod.live-1.cloud-platform.service.justice.gov.uk"
    protocol: sqs
    description: Production Environment

components:
  messages:
    prison-offender-events.prisoner.activities-changed:
      $ref: prisoner.activities-changed.yaml
    prison-offender-events.prisoner.appointments-changed:
      $ref: prisoner.appointments-changed.yaml
    prison-offender-events.prisoner.booking.moved:
      $ref: prisoner.booking.moved.yaml
    prison-offender-events.prisoner.cell.move:
      $ref: prisoner.cell.move.yaml
    prison-offender-events.prisoner.contact-added:
      $ref: prisoner.contact-added.yaml
    prison-offender-events.prisoner.contact-approved:
      $ref: prisoner.contact-approved.yaml
    prison-offender-events.prisoner.contact-removed:
      $ref: prisoner.contact-removed.yaml
    prison-offender-events.prisoner.contact-unapproved:
      $ref: prisoner.contact-unapproved.yaml
    prison-offender-events.prisoner.imprisonment-status-changed:
      $ref: prisoner.imprisonment-status-changed.yaml
    prison-offender-events.prisoner.merged:
      $ref: prisoner.merged.yaml
    prison-offender-events.prisoner.non-association-detail.changed:
      $ref: prisoner.non-association-detail.changed.yaml
    prison-offender-events.prisoner.person-restriction.deleted:
      $ref: prisoner.person-restriction.deleted.yaml
    prison-offender-events.prisoner.person-restriction.upserted:
      $ref: prisoner.person-restriction.upserted.yaml
    prison-offender-events.prisoner.received:
      $ref: prisoner.received.yaml
    prison-offender-events.prisoner.released:
      $ref: prisoner.released.yaml
    prison-offender-events.prisoner.restriction.changed:
      $ref: prisoner.restriction.changed.yaml
    prison-offender-events.prisoner.sentence-dates-changed:
      $ref: prisoner.sentence-dates-changed.yaml
    prison-offender-events.visitor.restriction.deleted:
      $ref: visitor.restriction.deleted.yaml
    prison-offender-events.visitor.restriction.upserted:
      $ref: visitor.restriction.upserted.yaml

channels:
  hmpps-domain-events:
    description: HMPPS domain events SNS topic
    bindings:
      sns:
        name: domainevents
    messages:
      prison-offender-events.prisoner.activities-changed:
        $ref: '#/components/messages/prison-offender-events.prisoner.activities-changed'
      prison-offender-events.prisoner.appointments-changed:
        $ref: '#/components/messages/prison-offender-events.prisoner.appointments-changed'
      prison-offender-events.prisoner.booking.moved:
        $ref: '#/components/messages/prison-offender-events.prisoner.booking.moved'
      prison-offender-events.prisoner.cell.move:
        $ref: '#/components/messages/prison-offender-events.prisoner.cell.move'
      prison-offender-events.prisoner.contact-added:
        $ref: '#/components/messages/prison-offender-events.prisoner.contact-added'
      prison-offender-events.prisoner.contact-approved:
        $ref: '#/components/messages/prison-offender-events.prisoner.contact-approved'
      prison-offender-events.prisoner.contact-removed:
        $ref: '#/components/messages/prison-offender-events.prisoner.contact-removed'
      prison-offender-events.prisoner.contact-unapproved:
        $ref: '#/components/messages/prison-offender-events.prisoner.contact-unapproved'
      prison-offender-events.prisoner.imprisonment-status-changed:
        $ref: '#/components/messages/prison-offender-events.prisoner.imprisonment-status-changed'
      prison-offender-events.prisoner.merged:
        $ref: '#/components/messages/prison-offender-events.prisoner.merged'
      prison-offender-events.prisoner.non-association-detail.changed:
        $ref: '#/components/messages/prison-offender-events.prisoner.non-association-detail.changed'
      prison-offender-events.prisoner.person-restriction.deleted:
        $ref: '#/components/messages/prison-offender-events.prisoner.person-restriction.deleted'
      prison-offender-events.prisoner.person-restriction.upserted:
        $ref: '#/components/messages/prison-offender-events.prisoner.person-restriction.upserted'
      prison-offender-events.prisoner.received:
        $ref: '#/components/messages/prison-offender-events.prisoner.received'
      prison-offender-events.prisoner.released:
        $ref: '#/components/messages/prison-offender-events.prisoner.released'
      prison-offender-events.prisoner.restriction.changed:
        $ref: '#/components/messages/prison-offender-events.prisoner.restriction.changed'
      prison-offender-events.prisoner.sentence-dates-changed:
        $ref: '#/components/messages/prison-offender-events.prisoner.sentence-dates-changed'
      prison-offender-events.visitor.restriction.deleted:
        $ref: '#/components/messages/prison-offender-events.visitor.restriction.deleted'
      prison-offender-events.visitor.restriction.upserted:
        $ref: '#/components/messages/prison-offender-events.visitor.restriction.upserted'

operations:
  publish-event:
    action: send
    channel:
      $ref: '#/channels/hmpps-domain-events'
    messages:
      - $ref: '#/components/messages/prison-offender-events.prisoner.appointments-changed'
      - $ref: '#/components/messages/prison-offender-events.prisoner.booking.moved'
      - $ref: '#/components/messages/prison-offender-events.prisoner.cell.move'
      - $ref: '#/components/messages/prison-offender-events.prisoner.contact-added'
      - $ref: '#/components/messages/prison-offender-events.prisoner.contact-approved'
      - $ref: '#/components/messages/prison-offender-events.prisoner.contact-removed'
      - $ref: '#/components/messages/prison-offender-events.prisoner.contact-unapproved'
      - $ref: '#/components/messages/prison-offender-events.prisoner.imprisonment-status-changed'
      - $ref: '#/components/messages/prison-offender-events.prisoner.merged'
      - $ref: '#/components/messages/prison-offender-events.prisoner.non-association-detail.changed'
      - $ref: '#/components/messages/prison-offender-events.prisoner.person-restriction.deleted'
      - $ref: '#/components/messages/prison-offender-events.prisoner.person-restriction.upserted'
      - $ref: '#/components/messages/prison-offender-events.prisoner.received'
      - $ref: '#/components/messages/prison-offender-events.prisoner.released'
      - $ref: '#/components/messages/prison-offender-events.prisoner.restriction.changed'
      - $ref: '#/components/messages/prison-offender-events.prisoner.sentence-dates-changed'
      - $ref: '#/components/messages/prison-offender-events.visitor.restriction.deleted'
      - $ref: '#/components/messages/prison-offender-events.visitor.restriction.upserted'
